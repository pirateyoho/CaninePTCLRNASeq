#!/bin/bash
# execute fastp on two paired-end reads of fastq files

#SBATCH --job-name=execute_fastp
#SBATCH --nodes=1
#SBATCH --ntasks=8 # modify this number to reflect how many cores you want to use (up to 64)
#SBATCH --partition=amilan
#SBATCH --qos=normal
#SBATCH --time=23:00:00
#SBATCH --output=log_fastp_%J.txt
#SBATCH --mail-type=END,FAIL,TIME_LIMIT
#SBATCH --mail-user=edlarsen@colostate.edu


# Initiate a bash array called SRRIDs
SRRIDs="CI101495 CI102794 CI104568 CI104569 CI104689 CI105160 CI105374 CI105488 CI105552 CI105669 CI105719 CI105729 CI105804 CI105835 CI106316 CI106347 CI106392 CI106419 CI124711 CI124777 CI124799 CI124809 CI149694 CI149695 CI150394 CI150689 CI150972 CI151879 CI152043 CI152139 CI152256 CI152603 CI152610 CI152824 CI152837 CI153051 CI153070 CI153316 CI153427 CI153429 CI154958 CI154980 CI155416 CI155427 CI155939 CI156336 CI156355 CI156615 CI156616 CI157907 CI157953 CI158400 CI158477 CI158538 CI158606 CI158821 CI159153 CI160115 CI160275 CI161206 CI161277 CI161398 CI162673 CI163077 CI163081 CI163085 CI164032 CI164076 CI164535 CI164787 CI164790 CI164860 CI164934 CI164968 CI165162 CI165189 CI165411 CI165426 CI165577 CI165644 CI165769 CI165776 CI166151 CI166393 CI166465 CI166472 CI166556 CI166625 CI167185 CI169715 CI171323 CI171436 CI171487 CI171535 CI171729 CI171788 CI171792 CI171818 CI171906 CI172331 CI80397 CI80399 CI80400"
 
# Loop through the SSRID array and run fastp on each:
for SRRID in $SRRIDs
do
     echo -e $SSRID
 
     fastp -i ../01_input/${SRRID}_1.fq.gz\
     -I ../01_input/${SRRID}_2.fq.gz\
     -o ../03_output/${SRRID}_trim_1.fq\
     -O ../03_output/${SRRID}_trim_2.fq\
     -h ../03_output/${SRRID}_report.html\
     -j ../03_output/${SRRID}_report.json\
     --detect_adapter_for_pe\
     --thread 1\
     -g -x -p
done
